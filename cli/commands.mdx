---
title: 'Commands'
description: 'Main command structure and usage patterns'
icon: 'code'
---

## Command Structure

Broccoli follows a simple command-line interface pattern:

```bash
broccoli [options]
```

All functionality is controlled through command-line flags. Broccoli does not use subcommands.

## Basic Examples

<CodeGroup>
```bash Default Usage
# Uses 'public' as source, generates public.gen.go
broccoli -src public
```

```bash Custom Output
# Generates assets.gen.go with variable named 'assets'
broccoli -src static -o assets -var assets
```

```bash Multiple Sources
# Combine multiple directories and files
broccoli -src "public,assets/logo.png,config"
```

```bash With Patterns
# Only include HTML and CSS files
broccoli -src public -include "*.html,*.css"
```
</CodeGroup>

## Usage Patterns

### Pattern 1: Basic Embedding

Embed a directory with default settings:

```bash
broccoli -src public
```

**What happens:**
- Reads all files in the `public` directory
- Uses maximum compression (level 11)
- Generates `public.gen.go`
- Creates variable named `br`

### Pattern 2: Custom Configuration

Customize the output file and variable name:

```bash
broccoli -src assets -o static -var staticFS
```

**What happens:**
- Reads `assets` directory
- Generates `static.gen.go`
- Creates variable named `staticFS`

### Pattern 3: Selective Inclusion

Include only specific file types:

```bash
broccoli -src public -include "*.html,*.css,*.js"
```

<Note>
When using `-include`, only files matching the patterns will be embedded. Directories are still traversed.
</Note>

### Pattern 4: Selective Exclusion

Exclude specific file types:

```bash
broccoli -src public -exclude "*.md,*.txt"
```

<Warning>
The `-include` and `-exclude` flags are mutually exclusive. You cannot use both in the same command.
</Warning>

### Pattern 5: Build Tags

Generate code with build constraints:

```bash
broccoli -src public -build "linux,386 darwin,!cgo"
```

**Generated file will include:**
```go
// +build linux,386 darwin,!cgo

// Code generated by broccoli at ...
```

### Pattern 6: Fast Compression

Use lower compression for faster builds during development:

```bash
broccoli -src public -quality 1
```

<Tip>
Use `-quality 1` during development for faster iteration, then switch to `-quality 11` for production builds.
</Tip>

### Pattern 7: Lazy Decompression

Enable optional decompression for on-demand file reading:

```bash
broccoli -src public -opt
```

**Behavior:**
- Without `-opt`: All files are decompressed when the program starts
- With `-opt`: Files are decompressed only when first accessed

### Pattern 8: Respect Gitignore

Automatically exclude files listed in `.gitignore`:

```bash
broccoli -src public -gitignore
```

<Note>
Broccoli will parse all `.gitignore` files in the directory tree and exclude matching files.
</Note>

### Pattern 9: Verbose Output

See detailed information during generation:

```bash
broccoli -src public -v
```

**Output includes:**
- Files being ignored
- Total bytes read
- Total bytes after compression

## go:generate Integration

### Basic Integration

Add to your Go source file:

```go main.go
package main

//go:generate broccoli -src public

import (
    "io"
    "log"
    "aletheia.icu/broccoli/fs"
)

func main() {
    // Open a file from the embedded bundle
    file, err := br.Open("index.html")
    if err != nil {
        log.Fatal(err)
    }
    defer file.Close()
    
    data, _ := io.ReadAll(file)
    println(string(data))
}
```

Run:
```bash
go generate
```

### Custom Variable Name

```go assets.go
package main

//go:generate broccoli -src assets -o broccoli -var broccoli

import (
    "io"
    "log"
    "aletheia.icu/broccoli/fs"
)

func main() {
    // Open a file from the embedded bundle
    file, err := broccoli.Open("logo.png")
    if err != nil {
        log.Fatal(err)
    }
    defer file.Close()
    
    data, _ := io.ReadAll(file)
}
```

### With Selective Inclusion

```go static.go
package web

//go:generate broccoli -src public -include="*.wasm"

import "aletheia.icu/broccoli/fs"

// br variable will only contain .wasm files
```

<Tip>
Document your `//go:generate` directives with comments explaining what files are being embedded and why.
</Tip>

## Command Output

When you run Broccoli:

**Success:**
```bash
$ broccoli -src public
$ # Silent on success
```

**With verbose flag:**
```bash
$ broccoli -src public -v
ignoring public/.DS_Store
total bytes read: 1048576
total bytes compressed: 524288
```

**Error:**
```bash
$ broccoli -src nonexistent
broccoli: file or directory nonexistent not found
```

## Exit Codes

- **0**: Success - file generated successfully
- **1**: Error - invalid options, file not found, or generation failed

## Help Command

Display help information:

```bash
broccoli
# or
broccoli -h
# or
broccoli --help
```

<Note>
Running `broccoli` without any arguments displays the help message.
</Note>

## Next Steps

<Card title="Flag Reference" icon="flag" href="/cli/flags">
  Explore detailed documentation for all CLI flags
</Card>
